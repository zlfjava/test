<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<script src="../../js/global.js"></script>
	</head>
	<body>
		<div class="x-nav">
			<span class="layui-breadcrumb">
		        <a href="">首页</a>
		        <a href="">学生管理</a>
		        <a><cite>学生信息</cite></a>
	        </span>
	        <a href="click_msg.html" style="cursor: pointer; margin-left: 1050px;" title="消息">
				<i class="layui-icon">&#xe63a;</i>
				<span id="">未读消息(</span>
				<span id="readMsg" style="color: red; font-size: 20px;">0</span>
				<span id="">)条</span>
	        </a>
			<a class="layui-btn layui-btn-small" style="line-height:1.6em;margin-top:3px;float:right" href="javascript:location.replace(location.href);" title="刷新">
				<i class="layui-icon" style="line-height:38px">&#xe669;</i>
			</a>
		</div>
		
		<!--tab选项卡-->
		<div class="layui-tab layui-tab-brief" lay-filter="docDemoTabBrief">
			<ul class="layui-tab-title">
				<li class="layui-this" id="temp_tab">我的学生</li>
				<li id="check_tab_li">未分配学生</li>
			</ul>
			<div class="layui-tab-content" style="height: 100px;">
				<div class="layui-tab-item layui-show">
					<!-- 条件查询区 -->
					<div class="layui-form-inline">
						<form class="layui-form" action="">
							<div class="layui-form-item">
								<label class="layui-form-mid">学生姓名：</label>
								<div class="layui-input-inline" style="width: 100px;">
									<input type="text" id="sname" placeholder="姓名关键字" autocomplete="off" class="layui-input">
								</div>
								<label class="layui-form-mid">学生年龄：</label>
								<div class="layui-input-inline" style="width: 90px;">
									<input type="number" id="sage" placeholder="最小年龄" autocomplete="off" class="layui-input">
								</div>
								<label class="layui-form-mid">—</label>
								<div class="layui-input-inline" style="width: 90px;">
									<input type="number" id="bigSage" placeholder="最大年龄" autocomplete="off" class="layui-input">
								</div>
								<label class="layui-form-mid">学生性别：</label>
								<div class="layui-input-inline" style="width: 100px;">
									<select id="sgender">
										<option value="">--请选择--</option>
										<option value="男">男</option>
										<option value="女">女</option>
									</select>
								</div>
								<label class="layui-form-mid">手机号：</label>
								<div class="layui-input-inline" style="width: 140px;">
									<input type="number" id="sphone" placeholder="学生手机号" autocomplete="off" class="layui-input">
								</div>
								<label class="layui-form-mid">QQ号：</label>
								<div class="layui-input-inline" style="width: 140px;">
									<input type="number" id="sqq" placeholder="学生QQ号" autocomplete="off" class="layui-input">
								</div>
								<label class="layui-form-mid">是否有效：</label>
								<div class="layui-input-inline" style="width: 100px;">
									<select id="iseffect">
										<option value="">--请选择--</option>
										<option value="是">是</option>
										<option value="否">否</option>
									</select>
								</div>
								<div class="layui-input-inline" style="width: 100px;">
									<button class="layui-btn" type="button" id="searsh">
								        <i class="layui-icon">&#xe615;</i>检索
								    </button>
								</div>
							</div>
							<div class="layui-form-item">
								<div class="layui-collapse layui-colla-item" lay-accordion>
								    <div class="layui-colla-item">
									    <h2 class="layui-colla-title">更多检索条件</h2>
									    <div class="layui-colla-content" style="height: 27px;">
									    	<label class="layui-form-mid">创建时间：</label>
											<div class="layui-input-inline" style="width: 150px;">
												<input type="text" id="screatetime" placeholder="开始时间" autocomplete="off" class="layui-input">
											</div>
											<div class="layui-form-mid">-</div>
											<div class="layui-input-inline" style="width: 150px;">
												<input type="text" id="sid" placeholder="结束时间" autocomplete="off" class="layui-input">
											</div>
											<label class="layui-form-mid">是否缴费：</label>
											<div class="layui-input-inline" style="width: 100px;">
												<select id="paythefees">
													<option value="">--请选择--</option>
													<option value="是">是</option>
													<option value="否">否</option>
												</select>
											</div>
											<label class="layui-form-mid">是否回访：</label>
											<div class="layui-input-inline" style="width: 100px;">
												<select id="isvisit">
													<option value="">--请选择--</option>
													<option value="是">是</option>
													<option value="否">否</option>
												</select>
											</div>
											<label class="layui-form-mid check_label">所属咨询师：</label>
											<div class="layui-input-inline check_div_inline" style="width: 120px;">
												<select name="szxsid" id="szxsid" class="fmk">
													<option value="">--请选择--</option>
												</select>
											</div>
									    </div>
								    </div>
								</div>
							</div>
						</form>
					</div>
					<!--显示学生信息的数据表格-->
					<table id="demo" lay-filter="test"></table>
				</div>
				<!--第二个tab选项卡-->
				<div class="layui-tab-item">
					<!-- 未分配学生条件查询区 -->
					<div class="layui-form-item" style="margin-left: 10px;">
						<form class="layui-form" action="">
							<label class="layui-form-mid">学生姓名：</label>
							<div class="layui-input-inline" style="width: 120px;">
								<input type="text" id="snameWfpxs" placeholder="姓名关键字" autocomplete="off" class="layui-input">
							</div>
							<label class="layui-form-mid">学生年龄：</label>
							<div class="layui-input-inline" style="width: 100px;">
								<input type="number" id="sageWfpxs" placeholder="最小年龄" autocomplete="off" class="layui-input">
							</div>
							<label class="layui-form-mid">—</label>
							<div class="layui-input-inline" style="width: 90px;">
								<input type="number" id="bigSageWfpxs" placeholder="最大年龄" autocomplete="off" class="layui-input">
							</div>
							<label class="layui-form-mid">学生性别：</label>
							<div class="layui-input-inline" style="width: 100px;">
								<select id="sgenderWfpxs">
									<option value="">--请选择--</option>
									<option value="男">男</option>
									<option value="女">女</option>
								</select>
							</div>
							<label class="layui-form-mid" style="margin-left: 5px;"></label>
							<div class="layui-input-inline">
								<button class="layui-btn" type="button" id="searshWfpxs">
							        <i class="layui-icon">&#xe615;</i>检索
							    </button>
							</div>
							<div class="layui-input-inline">
								<button class="layui-btn layui-btn-primary" type="reset">
							        <i class="layui-icon">&#x1006;</i>清空
							    </button>
						    </div>
						</form>
					</div>
					<!--未分配学生数据表格-->
					<table id="demoWfpxs" lay-filter="testWfpxs"></table>
				</div>
			</div>
		</div>
		
		<!-- 查看 -->
		<div id="detailDiv" style="display: none; margin-top: 10px;">
			<form class="layui-form" id="detailForm" lay-filter="detailForm">
				<div class="layui-input-inline" style="margin-bottom: 212px;">
					<!--<div class="layui-form-item" style="margin-left: 6px;">
						<label class="layui-form-mid">网络咨询师：</label>
						<div class="layui-input-inline" style="width: 490px;">
							<input type="text" name="loginname" id="sxname" disabled="disabled" placeholder="所属网络咨询师" autocomplete="off" class="layui-input">
						</div>
					</div>-->
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">客户姓名：</label>
						<div class="layui-input-inline">
							<input type="text" name="sname" placeholder="客户姓名" autocomplete="off" class="layui-input">
						</div>
						<label class="layui-form-mid" style="margin-left: 20px;">客户年龄：</label>
						<div class="layui-input-inline">
							<input type="number" name="sage" placeholder="客户年龄" autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 33px;">
						<label class="layui-form-mid">手机号：</label>
						<div class="layui-input-inline">
							<input type="number" name="sphone" placeholder="客户手机号" autocomplete="off" class="layui-input">
						</div>
						<label class="layui-form-mid" style="margin-left: 20px;">来源渠道：</label>
						<div class="layui-input-inline">
							<input type="text" name="sourcechannel" placeholder="客户手机号" autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 48px;">
						<label class="layui-form-mid">性别：</label>
						<div class="layui-input-inline">
							<input type="radio" name="sgender" value="男" title="男" checked="">
							<input type="radio" name="sgender" value="女" title="女">
						</div>
						<label class="layui-form-mid" style="margin-left: 5px;">来源关键词：</label>
						<div class="layui-input-inline">
							<input type="text" name="sourceword" placeholder="来源关键词" autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">客户学历：</label>
						<div class="layui-input-inline">
							<input type="text" name="seducation" placeholder="来源关键词" autocomplete="off" class="layui-input">
						</div>
						<label class="layui-form-mid"  style="margin-left: 39px;">QQ号：</label>
						<div class="layui-input-inline">
							<input type="number" name="sqq" placeholder="客户QQ号" autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">客户状态：</label>
						<div class="layui-input-inline">
							<input type="text" name="sstatus" autocomplete="off" class="layui-input">
						</div>
						<label class="layui-form-mid" style="margin-left: 33px;">微信号：</label>
						<div class="layui-input-inline">
							<input type="text" name="wechatid" placeholder="客户微信号" autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">来源网址：</label>
						<div class="layui-input-inline">
							<input type="text" name="sourceurl" autocomplete="off" class="layui-input">
						</div>
						<label class="layui-form-mid" style="margin-left: 20px;">创建时间：</label>
						<div class="layui-input-inline">
							<input type="text" name="screatetime" placeholder="yyyy-MM-dd HH:mm:ss" autocomplete="off" class="layui-input">
						</div>
					</div> 
					<div class="layui-form-item" style="margin-left: 48px;">
						<label class="layui-form-mid">备注：</label>
						<div class="layui-input-inline" style="width: 490px;">
							<textarea name="sremark" placeholder="备注内容" autocomplete="off" class="layui-textarea"></textarea>
						</div>
					</div>
				</div>
				<div class="layui-input-inline">
					<div class="layui-form-item" style="margin-left: 6px;">
						<label class="layui-form-mid">所属咨询师：</label>
						<div class="layui-input-inline" style="width: 490px;">
							<input type="text" name="szxsid" disabled="disabled" placeholder="所属咨询师" autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">课程方向：</label>
						<div class="layui-input-inline">
							<input type="text" name="course" placeholder="课程方向" autocomplete="off" class="layui-input">
						</div>
						<label class="layui-form-mid" style="margin-left: 20px;">客户打分：</label>
						<div class="layui-input-inline">
							<div><div id="testRateDetail"></div></div>
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">是否有效：</label>
						<div class="layui-input-inline">
							<input type="radio" name="iseffect" value="是" title="是">
							<input type="radio" name="iseffect" value="否" title="否">
						</div>
						<label class="layui-form-mid" style="margin-left: 20px;">无效原因：</label>
						<div class="layui-input-inline">
							<input type="text" name="invalidcause" placeholder="无效原因" autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">是否回访：</label>
						<div class="layui-input-inline">
							<input type="radio" name="isfirstvisit" value="是" title="是">
							<input type="radio" name="isfirstvisit" value="否" title="否">
						</div>
						<label class="layui-form-mid" style="margin-left: 20px;">首访时间：</label>
						<div class="layui-input-inline">
							<input type="text" name="firstvisittime" placeholder="yyyy-MM-dd HH:mm:ss" autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">是否上门：</label>
						<div class="layui-input-inline">
							<input type="radio" name="isvisit" value="是" title="是">
							<input type="radio" name="isvisit" value="否" title="否">
						</div>
						<label class="layui-form-mid"  style="margin-left: 20px;">上门时间：</label>
						<div class="layui-input-inline">
							<input type="text" name="visittime" placeholder="yyyy-MM-dd HH:mm:ss" autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">定金金额：</label>
						<div class="layui-input-inline">
							<input type="text" name="handselmoney" value="" placeholder="定金金额" autocomplete="off" class="layui-input">
						</div>
						<label class="layui-form-mid" style="margin-left: 20px;">定金时间：</label>
						<div class="layui-input-inline">
							<input type="text" name="handsetime" placeholder="yyyy-MM-dd HH:mm:ss" autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">是否缴费：</label>
						<div class="layui-input-inline">
							<input type="radio" name="paythefees" value="是" title="是">
							<input type="radio" name="paythefees" value="否" title="否">
						</div>
						<label class="layui-form-mid" style="margin-left: 20px;">缴费时间：</label>
						<div class="layui-input-inline">
							<input type="text" name="paythefeestime" placeholder="yyyy-MM-dd HH:mm:ss" autocomplete="off" class="layui-input">
						</div>
					</div> 
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">缴费金额：</label>
						<div class="layui-input-inline" style="width: 490px;">
							<input type="text" name="paymentamount" placeholder="缴费金额" autocomplete="off" class="layui-input">
						</div>
					</div> 
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">是否退费：</label>
						<div class="layui-input-inline">
							<input type="radio" name="isoutpay" value="是" title="是">
							<input type="radio" name="isoutpay" value="否" title="否">
						</div>
						<label class="layui-form-mid" style="margin-left: 20px;">退费原因：</label>
						<div class="layui-input-inline">
							<input type="text" name="isoutpaycause" placeholder="退费原因" autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">退费时间：</label>
						<div class="layui-input-inline"  style="width: 490px;">
							<input type="text" name="isoutpaytime" placeholder="yyyy-MM-dd HH:mm:ss" autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">是否进班：</label>
						<div class="layui-input-inline">
							<input type="radio" name="intheclass" value="是" title="是">
							<input type="radio" name="intheclass" value="否" title="否">
						</div>
						<label class="layui-form-mid" style="margin-left: 20px;">进班时间：</label>
						<div class="layui-input-inline">
							<input type="text" name="intheclasstime" placeholder="yyyy-MM-dd HH:mm:ss" autocomplete="off" class="layui-input">
						</div>
					</div> 
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">进班备注：</label>
						<div class="layui-input-inline">
							<textarea name="intheclassremark" placeholder="进班备注" autocomplete="off" class="layui-textarea"></textarea>
						</div>
						<label class="layui-form-mid" style="margin-left: 5px;">咨询师备注：</label>
						<div class="layui-input-inline">
							<textarea name="rremark" placeholder="咨询师备注" autocomplete="off" class="layui-textarea"></textarea>
						</div>
					</div>
				</div>
			</form>
		</div>
		
		<!--编辑-->
		<div id="editDiv" style="display: none; margin-top: 10px;">
			<form class="layui-form" id="editForm" lay-filter="editForm">
				<!--客户id主键  根据id修改-->
				<input type="text" name="sid" class="layui-input" style="display: none;">
				<div class="layui-input-inline" style="margin-bottom: 265px;">
					<!--<div class="layui-form-item" style="margin-left: 6px;">
						<label class="layui-form-mid">网络咨询师：</label>
						<div class="layui-input-inline" style="width: 490px;">
							<input type="text" name="loginname" id="editsxname" disabled="disabled" placeholder="所属网络咨询师" autocomplete="off" class="layui-input">
						</div>
					</div>-->
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">客户姓名：</label>
						<div class="layui-input-inline">
							<input type="text" name="sname" placeholder="客户姓名" autocomplete="off" class="layui-input">
						</div>
						<label class="layui-form-mid" style="margin-left: 20px;">客户年龄：</label>
						<div class="layui-input-inline">
							<input type="number" name="sage" placeholder="客户年龄" autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 33px;">
						<label class="layui-form-mid">手机号：</label>
						<div class="layui-input-inline">
							<input type="number" name="sphone" placeholder="客户手机号" autocomplete="off" class="layui-input">
						</div>
						<label class="layui-form-mid" style="margin-left: 20px;">来源渠道：</label>
						<div class="layui-input-inline">
							<select name="sourcechannel">
								<option value="">--请选择--</option>
								<option value="线下招生">线下招生</option>
								<option value="百度">百度</option>
								<option value="百度手机版">百度手机版</option>
								<option value="360搜索">360搜索</option>
							</select>
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 48px;">
						<label class="layui-form-mid">性别：</label>
						<div class="layui-input-inline">
							<input type="radio" name="sgender" value="男" title="男" checked="">
							<input type="radio" name="sgender" value="女" title="女">
						</div>
						<label class="layui-form-mid" style="margin-left: 5px;">来源关键词：</label>
						<div class="layui-input-inline">
							<input type="text" name="sourceword" placeholder="来源关键词" autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">客户学历：</label>
						<div class="layui-input-inline">
							<select name="seducation" required lay-verify="required">
								<option value="">--请选择--</option>
								<option value="未知">未知</option>
								<option value="小学">小学</option>
								<option value="初中">初中</option>
								<option value="高中">高中</option>
								<option value="大专">大专</option>
								<option value="本科">本科</option>
								<option value="硕士">硕士</option>
								<option value="博士">博士</option>
								<option value="其他">其他</option>
							</select>
						</div>
						<label class="layui-form-mid"  style="margin-left: 39px;">QQ号：</label>
						<div class="layui-input-inline">
							<input type="number" name="sqq" placeholder="客户QQ号" autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">客户状态：</label>
						<div class="layui-input-inline">
							<select name="sstatus">
								<option value="">--请选择--</option>
								<option value="未知">未知</option>
								<option value="待业">待业</option>
								<option value="在职">在职</option>
								<option value="在读">在读</option>
								<option value="就业">就业</option>
							</select>
						</div>
						<label class="layui-form-mid" style="margin-left: 33px;">微信号：</label>
						<div class="layui-input-inline">
							<input type="text" name="wechatid" placeholder="客户微信号" autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">来源网址：</label>
						<div class="layui-input-inline">
							<select name="sourceurl">
								<option value="">--请选择--</option>
								<option value="未知">未知</option>
								<option value="职英A站">职英A站</option>
								<option value="职英B站">职英B站</option>
								<option value="群英编程官网">群英编程官网</option>
							</select>
						</div>
						<label class="layui-form-mid" style="margin-left: 20px;">创建时间：</label>
						<div class="layui-input-inline">
							<input type="text" name="screatetime" id="editScreatetime" placeholder="yyyy-MM-dd HH:mm:ss" autocomplete="off" class="layui-input">
						</div>
					</div> 
					<div class="layui-form-item" style="margin-left: 48px;">
						<label class="layui-form-mid">备注：</label>
						<div class="layui-input-inline" style="width: 490px;">
							<textarea name="sremark" placeholder="备注内容" autocomplete="off" class="layui-textarea"></textarea>
						</div>
					</div>
				</div>
				<div class="layui-input-inline">
					<!--<div class="layui-form-item" style="margin-left: 6px;">
						<label class="layui-form-mid">所属咨询师：</label>
						<div class="layui-input-inline" style="width: 490px;">
							<input type="text" name="szxsid" disabled="disabled" placeholder="所属咨询师" autocomplete="off" class="layui-input">
						</div>
					</div>-->
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">课程方向：</label>
						<div class="layui-input-inline">
							<select name="course">
								<option value="">--请选择--</option>
								<option value="服务器开发">服务器开发</option>
								<option value="前端开发">前端开发</option>
								<option value="数据库管理">数据库管理</option>
								<option value="网络运维">网络运维</option>
								<option value="全栈开发">全栈开发</option>
							</select>
						</div>
						<label class="layui-form-mid" style="margin-left: 20px;">客户打分：</label>
						<div class="layui-input-inline">
							<div><div id="testRate"></div></div>	
							<input type="text" name="gradecase" id="editGradecase" style="display: none;" placeholder="客户打分" autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">是否有效：</label>
						<div class="layui-input-inline">	
							<input type="radio" name="iseffect" lay-filter="iseffectShi" value="是" title="是">
							<input type="radio" name="iseffect" lay-filter="iseffectFou" value="否" title="否">
						</div>	
						<label class="layui-form-mid" style="margin-left: 20px;">无效原因：</label>
						<div class="layui-input-inline">
							<input type="text" name="invalidcause" id="editInvalidcause" placeholder="无效原因" autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">是否回访：</label>
						<div class="layui-input-inline">	
							<input type="radio" name="isfirstvisit" lay-filter="isfirstvisitShi" value="是" title="是">
							<input type="radio" name="isfirstvisit" lay-filter="isfirstvisitFou" value="否" title="否">
						</div>
						<label class="layui-form-mid" style="margin-left: 20px;">首访时间：</label>
						<div class="layui-input-inline">
							<input type="text" name="firstvisittime"  id="editFirstvisittime" placeholder="yyyy-MM-dd HH:mm:ss" autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">是否上门：</label>
						<div class="layui-input-inline">	
							<input type="radio" name="isvisit" lay-filter="isvisitShi" value="是" title="是">
							<input type="radio" name="isvisit" lay-filter="isvisitFou" value="否" title="否">
						</div>
						<label class="layui-form-mid"  style="margin-left: 20px;">上门时间：</label>
						<div class="layui-input-inline">
							<input type="text" name="visittime" id="editVisittime" placeholder="yyyy-MM-dd HH:mm:ss" autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">定金金额：</label>
						<div class="layui-input-inline">
							<input type="number" name="handselmoney" id="editHandselmoney" onblur="handselmoneyBlur()" placeholder="定金金额" autocomplete="off" class="layui-input">
						</div>
						<label class="layui-form-mid" style="margin-left: 20px;">定金时间：</label>
						<div class="layui-input-inline">
							<input type="text" name="handsetime" id="editHandsetime" placeholder="yyyy-MM-dd HH:mm:ss" autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">是否缴费：</label>
						<div class="layui-input-inline">	
							<input type="radio" name="paythefees" lay-filter="paythefeesShi" value="是" title="是">
							<input type="radio" name="paythefees" lay-filter="paythefeesFou" value="否" title="否">
						</div>
						<label class="layui-form-mid" style="margin-left: 20px;">缴费时间：</label>
						<div class="layui-input-inline">
							<input type="text" name="paythefeestime" id="editPaythefeestime" placeholder="yyyy-MM-dd HH:mm:ss" autocomplete="off" class="layui-input">
						</div>
					</div> 
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">缴费金额：</label>
						<div class="layui-input-inline" style="width: 490px;">
							<input type="number" name="paymentamount" id="editPaymentamount" placeholder="缴费金额" autocomplete="off" class="layui-input">
						</div>
					</div> 
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">是否退费：</label>
						<div class="layui-input-inline">	
							<input type="radio" name="isoutpay" lay-filter="isoutpayShi" value="是" title="是">
							<input type="radio" name="isoutpay" lay-filter="isoutpayFou" value="否" title="否">
						</div>
						<label class="layui-form-mid" style="margin-left: 20px;">退费原因：</label>
						<div class="layui-input-inline">
							<input type="text" name="isoutpaycause" id="editIsoutpaycause" placeholder="退费原因" autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">退费时间：</label>
						<div class="layui-input-inline"  style="width: 490px;">
							<input type="text" name="isoutpaytime" id="editIsoutpaytime" placeholder="yyyy-MM-dd HH:mm:ss" autocomplete="off" class="layui-input">
						</div>
					</div>
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">是否进班：</label>
						<div class="layui-input-inline">	
							<input type="radio" name="intheclass" lay-filter="intheclassShi" value="是" title="是">
							<input type="radio" name="intheclass" lay-filter="intheclassFou" value="否" title="否">
						</div>
						<label class="layui-form-mid" style="margin-left: 20px;">进班时间：</label>
						<div class="layui-input-inline">
							<input type="text" name="intheclasstime" id="editIntheclasstime" placeholder="yyyy-MM-dd HH:mm:ss" autocomplete="off" class="layui-input">
						</div>
					</div> 
					<div class="layui-form-item" style="margin-left: 20px;">
						<label class="layui-form-mid">进班备注：</label>
						<div class="layui-input-inline">
							<textarea name="intheclassremark" placeholder="进班备注" autocomplete="off" class="layui-textarea"></textarea>
						</div>
						<label class="layui-form-mid" style="margin-left: 5px;">咨询师备注：</label>
						<div class="layui-input-inline">
							<textarea name="rremark" placeholder="咨询师备注" autocomplete="off" class="layui-textarea"></textarea>
						</div>
					</div>
					<div class="layui-form-item" id="deitBtnDiv" style="margin-left: 90px;">
						<label class="layui-form-mid"></label>
						<div class="layui-input-inline">
							<button class="layui-btn" lay-submit lay-filter="editBtn"><i class="layui-icon">&#xe605;</i>提交</button>
						</div>
					</div>
				</div>
			</form>
		</div>
		
		<!-- 跟踪弹出区 -->
		<div id="followsDiv" style="display: none; margin-top: 20px;">
			<form class="layui-form" id="followsForm" lay-filter="followsForm">
				<!--客户id主键  添加回访记录所需参数-->
				<input type="text" name="sid" id="followsSid" class="layui-input" style="display: none;">
				<input type="text" name="uid" id="followsUid" class="layui-input" style="display: none;">
				<div class="layui-form-item">
					<label class="layui-form-label" style="width: 100px;">回访时间：</label>
					<div class="layui-input-inline" style="width: 350px;">
						<input type="text" name="visittime" id="followsVisittime" placeholder="yyyy-MM-dd HH:mm:ss" required lay-verify="required" autocomplete="off" class="layui-input">
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label"  style="width: 100px;">回访情况：</label>
					<div class="layui-input-inline" style="width: 350px;">
						<input type="text" name="visitcase" placeholder="请输入回访情况" required lay-verify="required" autocomplete="off" class="layui-input">
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label"  style="width: 100px;">跟踪方式：</label>
					<div class="layui-input-inline" style="width: 350px;">
						<input type="text" name="trackingmode" placeholder="请输入跟踪方式" required lay-verify="required" autocomplete="off" class="layui-input">
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label"  style="width: 100px;">下次跟踪时间：</label>
					<div class="layui-input-inline" style="width: 350px;">
						<input type="text" name="nexttrackingtime" id="followsNexttrackingtime" placeholder="yyyy-MM-dd HH:mm:ss" required lay-verify="required" autocomplete="off" class="layui-input">
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label"  style="width: 100px;">状态：</label>
					<div class="layui-input-inline" style="width: 350px;">
						<input type="text" name="stustatus" placeholder="请输入客户状态" required lay-verify="required" autocomplete="off" class="layui-input">
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label"  style="width: 100px;">备注：</label>
					<div class="layui-input-inline" style="width: 350px;">
						<textarea name="fremark" placeholder="请输入备注" autocomplete="off" class="layui-textarea"></textarea>
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label"  style="width: 100px;"></label>
					<div class="layui-input-block">
						<button class="layui-btn" lay-submit lay-filter="followsBtn"><i class="layui-icon">&#xe605;</i>提交</button>
					</div>
				</div>
			</form>
		</div>
		
		<!--跟踪记录的修改-->
		<div id="editFollowsDiv" style="display: none; margin-top: 20px;">
			<form class="layui-form" id="editFollowsForm" lay-filter="editFollowsForm">
				<input type="hidden" name="fid" autocomplete="off" class="layui-input">
				<div class="layui-form-item">
					<label class="layui-form-label" style="width: 100px;">回访情况：</label>
					<div class="layui-input-inline"  style="width: 350px;">
						<textarea name="visitcase" placeholder="请输入内容" autocomplete="off" class="layui-textarea"></textarea>
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label" style="width: 100px;">跟踪方式：</label>
					<div class="layui-input-inline"  style="width: 350px;">
						<input type="text" name="trackingmode" placeholder="请输入跟踪方式" autocomplete="off" required lay-verify="required" class="layui-input">
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label" style="width: 100px;">跟踪时间：</label>
					<div class="layui-input-inline"  style="width: 350px;">
						<input type="text" name="visittime" id="editFollowsVisittime" placeholder="yyyy-MM-dd HH:mm:ss" autocomplete="off" required lay-verify="required" class="layui-input">
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label" style="width: 100px;">下次跟踪时间：</label>
					<div class="layui-input-inline"  style="width: 350px;">
						<input type="text" name="nexttrackingtime" id="editFollowsNexttrackingtime" placeholder="yyyy-MM-dd HH:mm:ss" autocomplete="off" required lay-verify="required" class="layui-input">
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label" style="width: 100px;">状态：</label>
					<div class="layui-input-inline"  style="width: 350px;">
						<input type="text" name="stustatus" placeholder="请输入状态" autocomplete="off" required lay-verify="required" class="layui-input">
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label" style="width: 100px;">备注：</label>
					<div class="layui-input-inline"  style="width: 350px;">
						<input type="text" name="fremark" placeholder="请输入备注" autocomplete="off" required lay-verify="required" class="layui-input">
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label" style="width: 100px;"></label>
					<div class="layui-input-inline">
						<button class="layui-btn" lay-submit lay-filter="editFollowsBtn"><i class="layui-icon">&#xe605;</i>提交</button>
					</div>
				</div>
			</form>
		</div>
		
		<!--学生信息数据表格头部工具栏-->
		<div id="toolbarDemo" class="check_div">
			<div class="layui-btn-container">
			    <button class="layui-btn layui-btn-sm" lay-event="exportLieBiao">
			    	<i class="layui-icon">&#xe61f;</i>添加到导出列表
			    </button>
			    <button class="layui-btn layui-btn-sm" lay-event="exportFile">
			    	<i class="layui-icon">&#xe67d;</i>导出Excel文件
			    </button>
			    <button type="button" class="layui-btn layui-btn-sm check_gongNeng" id="importBtn">
			    	<i class="layui-icon">&#xe67c;</i>上传Excel文件
			    </button>
			    <button class="layui-btn layui-btn-sm layui-btn-danger check_deletelist" lay-event="mildDelListStuBtn">
			    	<i class="layui-icon">&#xe640;</i>批量删除
			    </button>
		    </div>
		</div>
		
		<!--学生信息行内工具栏-->
		<div id="barDemo" class="check_div">
			<button class="layui-btn layui-btn-xs check_detail" lay-event="detail">
		    	<i class="layui-icon">&#xe60b;</i>查看
		    </button>
		    <button class="layui-btn layui-btn-xs check_edit" lay-event="edit">
		    	<i class="layui-icon">&#xe642;</i>编辑
		    </button>
		    <button class="layui-btn layui-btn-xs layui-btn-warm check_add" lay-event="follows">
		    	<i class="layui-icon">&#xe63a;</i>跟踪
		    </button>
		    <button class="layui-btn layui-btn-xs layui-btn-normal check_setRoles" lay-event="followsRz">
		    	<i class="layui-icon">&#xe60e;</i>日志
		    </button>
		    <button class="layui-btn layui-btn-xs layui-btn-danger check_delete" lay-event="mildDel">
		    	<i class="layui-icon">&#xe640;</i>删除
		    </button>
		</div>
		
		<!--日志信息行内工具栏-->
		<script type="text/html" id="barDemoFollows">
			<a class="layui-btn layui-btn-xs" lay-event="detail"><i class="layui-icon">&#xe60b;</i>查看</a>
			<a class="layui-btn layui-btn-xs" lay-event="edit"><i class="layui-icon">&#xe642;</i>编辑</a>
			<a class="layui-btn layui-btn-xs layui-btn-danger" lay-event="del"><i class="layui-icon">&#xe640;</i>删除</a>
		</script>
		
		<!--跟踪记录的条件查询区-->
		<div id="demoFollowsDiv" style="display: none;">
			<!-- 条件查询区 -->
			<div class="layui-form-item" style="margin-left: 10px; margin-top: 20px;">
				<form class="layui-form" action="">
					<label class="layui-form-mid">跟踪方式：</label>
					<div class="layui-input-inline" style="width: 150px;">
						<input type="text" id="searchTrackingmode" placeholder="关键字" autocomplete="off" class="layui-input">
					</div>
					<label class="layui-form-mid">跟踪时间：</label>
					<div class="layui-input-inline" style="width: 200px;">
						<input type="text" id="searchBeginTime" placeholder="开始时间" autocomplete="off" class="layui-input">
					</div>
					<label class="layui-form-mid">--</label>
					<div class="layui-input-inline" style="width: 200px;">
						<input type="text" id="searchEndTime" placeholder="结束时间" autocomplete="off" class="layui-input">
					</div>
					<button class="layui-btn" type="button" id="searshFollows">
				        <i class="layui-icon">&#xe615;</i>检索
				    </button>
				    <button class="layui-btn layui-btn-primary" type="reset" id="resetSearch">
				        <i class="layui-icon">&#x1006;</i>清空
				    </button>
				    <button class="layui-btn layui-btn-danger"  style="margin-left: 50px;" id="delListBtn">
				    	<i class="layui-icon">&#xe640;</i>批量删除
				    </button>
				</form>
			</div>
			<!--显示学生日志的数据表格-->
			<table id="demoFollows" lay-filter="demoFollows"></table>
		</div>
		
		<!--跟踪记录的详情 -->
		<div id="detailFollowsDiv" style="display: none; margin-top: 20px;">
			<form class="layui-form" id="detailFollowsForm" lay-filter="detailFollowsForm">
				<div class="layui-form-item">
					<label class="layui-form-label" style="width: 100px;">跟踪方式：</label>
					<div class="layui-input-inline"  style="width: 350px;">
						<input type="text" name="trackingmode" placeholder="请输入跟踪方式" autocomplete="off" required lay-verify="required" class="layui-input">
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label" style="width: 100px;">跟踪时间：</label>
					<div class="layui-input-inline"  style="width: 350px;">
						<input type="text" name="visittime" placeholder="yyyy-MM-dd HH:mm:ss" autocomplete="off" required lay-verify="required" class="layui-input">
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label" style="width: 100px;">下次跟踪时间：</label>
					<div class="layui-input-inline"  style="width: 350px;">
						<input type="text" name="nexttrackingtime" placeholder="yyyy-MM-dd HH:mm:ss" autocomplete="off" required lay-verify="required" class="layui-input">
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label" style="width: 100px;">回访情况：</label>
					<div class="layui-input-inline"  style="width: 350px;">
						<textarea name="visitcase" placeholder="请输入内容" autocomplete="off" class="layui-textarea"></textarea>
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label" style="width: 100px;">状态：</label>
					<div class="layui-input-inline" style="width: 350px;">
						<input type="text" name="stustatus" placeholder="请输入状态" autocomplete="off" required lay-verify="required" class="layui-input">
					</div>
				</div>
				<div class="layui-form-item">
					<label class="layui-form-label" style="width: 100px;">备注：</label>
					<div class="layui-input-inline"  style="width: 350px;">
						<input type="text" name="fremark" placeholder="请输入备注" autocomplete="off" required lay-verify="required" class="layui-input">
					</div>
				</div>
			</form>
		</div>
		
		<!-- 分配-->
		<div id="editWfpxsDiv" style="display: none; margin-top: 30px;">
			<form class="layui-form" id="editWfpxsForm" lay-filter="editWfpxsForm">
				<input type="text" id="sid" name="sid" style="display: none;" class="layui-input">
				<div class="layui-form-item" style="margin-left: 20px;">
					<label class="layui-form-mid">在线咨询师：</label>
					<div class="layui-input-inline">
						<select name="uphone" id="uphone" class="zxs" lay-search lay-filter="uphone">
							<option value="">--请选择--</option>
						</select>
					</div>
					<label class="layui-form-mid">所属学生人数：</label>
					<div class="layui-input-inline" style="width: 120px;">
						<input type="text" id="num" autocomplete="off" readonly="readonly" style="border: hidden; color: green;" class="layui-input">
					</div>
				</div>
				<div class="layui-form-item" style="margin-left: 105px;">
					<label class="layui-form-mid"></label>
					<div class="layui-input-inline">
						<button class="layui-btn" lay-submit lay-filter="editWfpxsBtn"><i class="layui-icon">&#xe605;</i>分配</button>
					</div>
				</div>
			</form>
		</div>

		<!-- 批量分配-->
		<div id="PLeditDiv" style="display: none; margin-top: 30px;">
			<form class="layui-form" id="PLeditForm" lay-filter="PLeditForm">
				<div class="layui-form-item" style="margin-left: 20px;">
					<label class="layui-form-mid">在线咨询师：</label>
					<div class="layui-input-inline">
						<select name="uphone" id="PLuphone" class="zxs" lay-search lay-filter="PLuphone">
							<option value="">--请选择--</option>
						</select>
					</div>
					<label class="layui-form-mid">所属人数：</label>
					<div class="layui-input-inline" style="width: 120px;">
						<input type="text" id="PLnum" readonly="readonly" style="border: hidden; color: green;" autocomplete="off" class="layui-input">
					</div>
				</div>
				<div class="layui-form-item" style="margin-left: 105px;">
					<label class="layui-form-mid"></label>
					<div class="layui-input-inline">
						<button class="layui-btn" lay-submit lay-filter="PLeditBtn"><i class="layui-icon">&#xe605;</i>分配</button>
					</div>
				</div>
			</form>
		</div>
		
		<!--未分配学生数据表格头部工具栏-->
		<script type="text/html" id="toolbarDemoWfpxs">
		    <div class="layui-btn-container">
		    	<button class="layui-btn layui-btn-sm" lay-event="testFenpei">
			    	<i class="layui-icon">&#xe67d;</i>自动分配
			    </button>
			    <button class="layui-btn layui-btn-sm" lay-event="exportLieBiaoWfpxs">
			    	<i class="layui-icon">&#xe61f;</i>添加到分配列表
			    </button>
			    <button class="layui-btn layui-btn-sm" lay-event="exportFileWfpxs">
			    	<i class="layui-icon">&#xe67d;</i>分配
			    </button>
		    </div>
		</script>
		
		<!--未分配学生行内工具栏-->
		<script type="text/html" id="barDemoWfpxs">
			<a class="layui-btn layui-btn-xs" lay-event="detail"><i class="layui-icon">&#xe60b;</i>分配</a>
		</script>
		
		<!--js代码-->
		<script>
			layui.use(['table', 'form', 'layer', 'laydate', 'element', 'upload', 'rate'], function() {
				var table = layui.table;
				var form = layui.form;
				var layer = layui.layer;
				var laydate = layui.laydate;
				var upload = layui.upload;
				var rate = layui.rate;
				var $ = layui.$;
				
				//咨询师的下拉框
				$.post(globalData.server + "/users/getUserByRoles", {
					"token": globalData.getToken(),
					"uid": globalData.getUid()
				}, function(res) {	//遍历返回的数据
					$.each(res, function(index, item) {
						$(".fmk").append(new Option(item.loginname, item.loginname));
					});
					layui.form.render();
				}, "json");
				
				/**
				 * 页面加载初始化查询  查询当前登录的咨询师有多少条未读的动态推送消息
				 */
				$.post(globalData.server + "/dynamicmessage/getCountByUid", {
					"uid": globalData.getUid(),
					'token': globalData.getToken()
				}, function(res){
					$("#readMsg").html(res);
				}, "json");
				
				/**
				 * 每三秒执行一次
				 */
				setInterval(function(){
					$.post(globalData.server + "/dynamicmessage/getCountByUid", {
						"uid": globalData.getUid(),
						'token': globalData.getToken()
					}, function(res){
						$("#readMsg").html(res);
					}, "json");
				}, 3000);
				
				//判断权限值  根据权限值显示操作按钮
				for (var i = 0; i < tempQuanXian.length; i++) {
					/*批量删除学生信息*/
					if (tempQuanXian[i] == "myStudent:delList") {
						$(".check_deletelist").attr("style", "display: inline;");
					}
					/*添加跟踪记录*/
					if (tempQuanXian[i] == "myStudent:follows") {
						$(".check_add").attr("style", "display: inline;");
					}
					/*查看日志*/
					if (tempQuanXian[i] == "myStudent:followsRz") {
						$(".check_setRoles").attr("style", "display: inline;");
					}
					/*查看学生信息*/
					if (tempQuanXian[i] == "myStudent:detail") {
						$(".check_detail").attr("style", "display: inline;");
					}
					/*编辑学生信息*/
					if (tempQuanXian[i] == "myStudent:edit") {
						$(".check_edit").attr("style", "display: inline;");
					}
					/*单个删除学生信息*/
					if (tempQuanXian[i] == "myStudent:del") {
						$(".check_delete").attr("style", "display: inline;");
					}
					/* 咨询师查询条件*/
					if (tempQuanXian[i] == "myStudent:selectZxs") {
						$(".check_label").attr("style", "display: inline;");
						$(".check_div_inline").attr("style", "display: inline;");
					}
					/* 导入Excel文件*/
					if (tempQuanXian[i] == "myStudent:importExcel") {
						$(".check_gongNeng").attr("style", "display: inline;");
					}
				}
				
				var uphone =  globalData.getProtectmtel();	//存储手机号参数
				var rremark = "";	//存储未分配学生
				
				for (var i = 0; i < tempQuanXian.length; i++) {
					if (tempQuanXian[i] == "myStudent:getAll") {	//判断有没有查看所有学生信息的权限
						uphone = "";	//如果有 取消手机号参数
						rremark = "未分配";	//设置参数
						$("#temp_tab").html("已分配学生");	//更改tab选项卡的内容
						$("#check_tab_li").attr("style", "display: inline;");
					}
				}
				
				//渲染数据表格
				table.render({
					elem: '#demo',
					url: globalData.server + "/students/getAllstu",
					method: 'post',
					page: true,
					limit: '9',
					where: {
						'token': globalData.getToken(),
						'ifvalid': '是',	//只查询有效学生  没有被软删除的
						'uphone': uphone,	//根据手机号查询咨询师下学生
						'rremark': rremark	//值查询已分配的学生，后端 != "已分配"
					}, //验证
					toolbar: '#toolbarDemo', //开启头部工具栏，并为其绑定左侧模板
					cols: [[
						{type: 'checkbox'},
						{type: 'numbers', title: '序号', align: 'center'},
						{field: 'sname', title: '学生姓名', width: 100, align: 'center'},
						{field: 'sage', title: '年龄', width: 60, align: 'center'},
						{field: 'sgender', title: '性别', width: 60, align: 'center'},
						{field: 'sphone', title: '手机号', width: 120, align: 'center'},
						{field: 'sstatus', title: '状态', width: 80, align: 'center'},
						{field: 'sourcechannel', title: '来源渠道', width: 120, align: 'center'},
						{field: 'sourceword', title: '来源关键字', width: 100, align: 'center'},
						{field: 'sqq', title: '客户qq', width: 120, align: 'center'},
						{field: 'wechatid', title: '微信', width: 115, align: 'center'},
						{field: 'screatetime', title: '创建时间', width: 160, align: 'center'},
						{field: 'seducation', title: '客户学历', width: 160, align: 'center', hide: true},
						{field: 'sourceurl', title: '来源网址', width: 160, align: 'center', hide: true},
						{field: 'sremark', title: '备注', width: 160, align: 'center', hide: true},
						{field: 'gradecase', title: '打分情况', width: 160, align: 'center', hide: true},
						{field: 'course', title: '课程方向', width: 160, align: 'center', hide: true},
						{field: 'iseffect', title: '是否有效', width: 160, align: 'center', hide: true},
						{field: 'invalidcause', title: '无效原因', width: 160, align: 'center', hide: true},
						{field: 'isfirstvisit', title: '首次回访', width: 160, align: 'center', hide: true},
						{field: 'firstvisittime', title: '首次回访时间', width: 160, align: 'center', hide: true},
						{field: 'isvisit', title: '是否上门', width: 160, align: 'center', hide: true},
						{field: 'visittime', title: '上门时间', width: 160, align: 'center', hide: true},
						{field: 'handselmoney', title: '定金金额', width: 160, align: 'center', hide: true},
						{field: 'handsetime', title: '定金时间', width: 160, align: 'center', hide: true},
						{field: 'paythefees', title: '是否缴费', width: 160, align: 'center', hide: true},
						{field: 'paythefeestime', title: '缴费时间', width: 160, align: 'center', hide: true},
						{field: 'paymentamount', title: '缴费金额', width: 160, align: 'center', hide: true},
						{field: 'isoutpay', title: '是否退费', width: 160, align: 'center', hide: true},
						{field: 'isoutpaycause', title: '退费原因', width: 160, align: 'center', hide: true},
						{field: 'isoutpaytime', title: '退费时间', width: 160, align: 'center', hide: true},
						{field: 'intheclass', title: '是否进班', width: 160, align: 'center', hide: true},
						{field: 'intheclasstime', title: '进班时间', width: 160, align: 'center', hide: true},
						{title: '操作', align: 'center', width: 345, toolbar: '#barDemo'}
					]],
					id: "reloadId"
				});
				
				var idss = [];	//创建数组 存储sid参数
				var repeatSname = [];	//存储重复数据
				//头工具栏事件
			    table.on('toolbar(test)', function(obj){
				    switch(obj.event){
				        case 'exportLieBiao':	//添加到导出列表的按钮
					        var check = table.checkStatus("reloadId");	//获取数据表格
							var data = check.data;	//获取数据表格里的数据
							repeatSname = [];	//清空提示
							for (var i = 0; i < data.length; i++) {	//查找重复数据
								for (var j = 0; j < idss.length; j++) {
									if (data[i].sid == idss[j]) {
										repeatSname.push(data[i].sname);	//添加重复数据
									}
								}
							}
							if (repeatSname.length > 0) {
								layer.alert("所选包含重复数据:" + repeatSname, {icon : 3});
								return false;
							}
							//遍历数据
							for (var i = 0; i < data.length; i++) {
								idss.push(data[i].sid);	//取出sid并添加到数组中
							}
							if (data.length < 1) {
								layer.msg("您还没有选择数据", {icon : 5});
								return false;
							}
							layer.msg("当前" + data.length + "条数据已添加至列表", {icon : 1});
				        	break;
				        case 'exportFile':	//文件导出按钮
							if (idss == null || idss == "") {	//判断是否勾选了数据	如果没有勾选  默认是导出所有
								table.reload("reloadId", {
									where: {"limit": 100000}, page: {curr: 1}
								});	//重载数据表格
								layer.confirm("确认要导出全部数据吗？", {icon : 6}, function(){	//导出全部数据提示
									var kmnh = layui.table.cache["reloadId"];	//获取表格的全部数据
									for (var i = 0; i < kmnh.length; i++) {	//循环遍历
										idss.push(kmnh[i].sid);		//添加到数组
									}
									var idJoin = idss.join(",");	//使用逗号分隔参数
									//请求地址
									window.location.href = globalData.server + "/students/xsxxExportStudents?&token=" + globalData.getToken() + "&ids=" + idJoin;
									layer.msg("文件已下载", {icon : 1});	//成功后提示
									idss = [];	//导出成功后 清空id数组 方便下次存储数据
									table.reload("reloadId", {
										where: {"limit": 10}, page: {curr: 1}
									});	//重载数据表格
								}, function(){
									layer.msg("已取消", {icon : 6});
									table.reload("reloadId", {
										where: {"limit": 10}, page: {curr: 1}
									});	//重载数据表格
								});
							} else {
								layer.confirm("共选择了【"+ idss.length +"】条数据，确认导出吗？", {icon : 6}, function(){
									var idJoin = idss.join(",");	//使用逗号分隔参数
									//请求地址
									window.location.href = globalData.server + "/students/xsxxExportStudents?&token=" + globalData.getToken() + "&ids=" + idJoin;
									layer.msg("文件已下载", {icon : 1});	//成功后提示
									active.reload(); //重载数据表格
									idss = [];	//导出成功后 清空id数组 方便下次存储数据
									repeatSname = [];	//导出成功后 清空重复数据 方便下下次提示
								});
							}
				        	break;
				        case 'mildDelListStuBtn':
				        	var check = table.checkStatus("reloadId");	//获取数据表格
							var data = check.data;	//获取数据表格里面的数据
							var ids = [];	//创建数据，存储uid
							//遍历选中的数据
							for (var i = 0; i < data.length; i++) {
								ids.push(data[i].sid);	//取出uid并添加到数组中
							}
							var idJoin = ids.join(",");  //使用逗号分隔uid
							if (ids == null || ids == "") {	//判断是否勾选了数据
								layer.msg("请先选择要删除的数据", {icon : 5});	//没选择给出提示
								return false;	//结束方法
							}
							layer.confirm("确认删除这["+ ids.length +"]条数据吗？", function(){
								var delUrl = globalData.server + "/students/mildDel";	//请求地址
								//请求参数
								var strData = {
									"sid": idJoin,
									"ifvalid": "否",
									"token": globalData.getToken()
								}
								//post请求
								$.post(delUrl, strData, function(res){
									if (res > 0) {
										layer.msg("删除成功! 可在回收站查看", {icon : 1});
										active.reload();
									} else{
										layer.msg("删除失败!", {icon : 5});
									}					
								}, "json");
							});
				        	break;
				      	case 'LAYTABLE_TIPS':	//自定义头工具栏右侧图标 - 提示
				        	layer.alert('这是工具栏右侧自定义的一个图标按钮');
				      		break;
				    };
			    });
				
				//监听工具条 
				table.on('tool(test)', function(obj) { //注：tool 是工具条事件名，test 是 table 原始容器的属性 lay-filter="对应的值"
					var data = obj.data; //获得当前行数据
					var layEvent = obj.event; //获得 lay-event 对应的值（也可以是表头的 event 参数对应的值）
					var tr = obj.tr; //获得当前行 tr 的 DOM 对象（如果有的话）
					var uid = data.uid; //获得当前点击的uid
					//根据uid 查询姓名
					var editUrl = globalData.server + "/users/findByUid"; //请求地址
					var strData = {
						"uid": uid,
						"token": globalData.getToken()
					}
					$.post(editUrl, strData, function(res) {
						$("#sxname").val(res.loginname);
						$("#editsxname").val(res.loginname);
					}, "json");
					if(layEvent === 'detail') { //查看
						//渲染评分 testRate editGradecase
						rate.render({
						    elem: '#testRateDetail',	//绑定元素
						    length: 5,	//星星个数
						    theme: '#009688',	//颜色
						    value: data.gradecase //初始值
						});
						form.val("detailForm", data); //数据回显
						layer.open({
							type: 1,
							title: "您正在查看[" + data.sname + "]客户的信息",
							anim: 1,
							maxmin: true,
							offset: '1px',
							area: ['1280px', '730px'],
							content: $('#detailDiv'),
							cancel: function(index, layero){ 	//弹窗关闭时的回调函数
							    layer.msg("已关闭", {icon : 6});	//提示已关闭
							    layer.close(index);	//关闭弹出层
							  	return false; 
							}  
						});
					} else if(layEvent === 'edit'){ //编辑
						//editInvalidcause	无效原因
						if (data.iseffect == "是") {
							$("#editInvalidcause").prop("disabled", "disabled");
							$("#editInvalidcause").attr("style", "background-color: lightgray;");
						}
						//editFirstvisittime	首访时间
						if (data.isfirstvisit == "否") {
							$("#editFirstvisittime").prop("disabled", "disabled");
							$("#editFirstvisittime").attr("style", "background-color: lightgray;");
						}
						//editVisittime	上门时间
						if (data.isvisit == "否") {
							$("#editVisittime").prop("disabled", "disabled");
							$("#editVisittime").attr("style", "background-color: lightgray;");
						}
						//editHandsetime	定金时间
						if (data.handselmoney == null) {
							$("#editHandsetime").prop("disabled", "disabled");
							$("#editHandsetime").attr("style", "background-color: lightgray;");
						}
						//editPaythefeestime editPaymentamount	缴费时间 缴费金额
						if (data.paythefees == "否") {
							$("#editPaythefeestime").prop("disabled", "disabled");
							$("#editPaythefeestime").attr("style", "background-color: lightgray;");
							$("#editPaymentamount").prop("disabled", "disabled");
							$("#editPaymentamount").attr("style", "background-color: lightgray;");
						}
						//editIsoutpaycause editIsoutpaytime	退费原因 退费时间
						if (data.isoutpay == "否") {
							$("#editIsoutpaycause").prop("disabled", "disabled");
							$("#editIsoutpaycause").attr("style", "background-color: lightgray;");
							$("#editIsoutpaytime").prop("disabled", "disabled");
							$("#editIsoutpaytime").attr("style", "background-color: lightgray;");
						}
						//editIntheclasstime	进班时间
						if (data.intheclass == "否") {
							$("#editIntheclasstime").prop("disabled", "disabled");
							$("#editIntheclasstime").attr("style", "background-color: lightgray;");
						}
						//渲染评分 testRate editGradecase
						rate.render({
						    elem: '#testRate',	//绑定元素
						    length: 5,	//星星个数
						    theme: '#009688',	//颜色
						    value: data.gradecase, //初始值
						    choose: function(value){	//点击时的回调
							    $("#editGradecase").val(value);	//将值设置到输入框
							}
						});
						form.val("editForm", data); //数据回显
						layer.open({
							type: 1,
							title: "您正在编辑[" + data.sname + "]客户的信息",
							anim: 1,
							maxmin: true,
							offset: '1px',
							area: ['1280px', '730px'],
							content: $('#editDiv')
						});
					} else if(layEvent === 'follows'){ //跟踪
						$("#followsSid").val(data.sid);	//回显客户id  客户id是新增回访记录的必要参数
						$("#followsUid").val(globalData.getUid());	//回显员工id 从globalData全局js文件中获取
						layer.open({
							type: 1,
							title: "您正与[" + data.sname + "]客户进行沟通",
							anim: 1,
							maxmin: true,
							offset: '80px',
							area: ['600px', '550px'],
							content: $('#followsDiv'),
							cancel: function(index, layero){ 	//弹窗关闭时的回调函数
							    layer.msg("已关闭", {icon : 6});	//提示已关闭
							    layer.close(index);	//关闭弹出层
							    $("#followsForm")[0].reset();
							  	return false; 
							}
						});
					}  else if(layEvent === 'followsRz'){ //日志
						$("#resetSearch").click();
						table.reload("followsReloadId", {	//重载数据表格
							where: {"sid": data.sid, "token": globalData.getToken()},
							page: {curr: 1}
						});
						layer.open({
							type: 1,
							title: "您正在查看[" + data.sname + "]客户的沟通日志",
							anim: 1,
							maxmin: true,
							offset: '1px',
							area: ['1500px', '730px'],
							content: $('#demoFollowsDiv'),
							cancel: function(index, layero){ 	//弹窗关闭时的回调函数
							    layer.msg("已关闭", {icon : 6});	//提示已关闭
							    layer.close(index);	//关闭弹出层
							  	return false; 
							}
						});
					}  else if(layEvent === 'mildDel'){ //删除学生（软删除）
						layer.confirm("确认要删除[" + data.sname + "]吗？", function(){
							var delUrl = globalData.server + "/students/mildDel";	//请求地址
							//请求参数
							var strData = {
								"sid": data.sid,
								"ifvalid": "否",
								"token": globalData.getToken()
							}
							//post请求
							$.post(delUrl, strData, function(res){
								if (res > 0) {
									layer.msg("删除成功! 可在回收站查看", {icon : 1});
									active.reload();
								} else{
									layer.msg("删除失败!", {icon : 5});
								}					
							}, "json");
						});
					}
				});
				
				//监听提交   编辑
				form.on('submit(editBtn)', function(data) {
					var editUrl = globalData.server + "/students/editStu"; //请求地址
					var strData = $("#editForm").serialize() + "&token=" + globalData.getToken() + "&uphone=" + globalData.getProtectmtel();
					//发异步，把数据提交给java
					$.post(editUrl, strData, function(res) {
						if(res.code > 0) {
							layer.closeAll();
							layer.msg(res.msg, {icon: 1});
							table.reload("reloadId", {});
						} else {
							layer.msg(res.msg, {icon: 5});
						}
					}, "json");
					return false;
				});
				
				//监听提交   跟踪
				form.on('submit(followsBtn)', function(data) {
					var followsUrl = globalData.server + "/follows/add"; //请求地址
					var strData = $("#followsForm").serialize() + "&token=" + globalData.getToken();
					//发异步，把数据提交给java
					$.post(followsUrl, strData, function(res) {
						if(res.code > 0) {
							layer.closeAll();
							layer.msg(res.msg, {icon: 1});
							$("#followsForm")[0].reset();
							active.reload();
						} else {
							layer.msg(res.msg, {icon: 5});
						}
					}, "json");
					return false;
				});
				
				//绑定文件上传按钮  指定允许上传的文件类型
			  	upload.render({
			    	elem: '#importBtn',
			    	url: globalData.server + "/students/importStudents?token=" 
			    		+ globalData.getToken() + "&uid=" + globalData.getUid(), //改成您自己的上传接口
			    	accept: 'file', //普通文件
			    	done: function(res){
				      	layer.msg(res.num, {icon: 6});
				      	activeWfpxs.reload();
			    	}
			    });
				
				//点击学生信息检索按钮时触发
				$("#searsh").on("click", function() {
					active.reload();
					return false;
				});

				/**
				 * 重载数据表格的方法
				 * 参数 sname sage sphone sqq sgender szxsid screatetime sourceword paythefees isvisit
				 */
				active = {
					reload: function() {
						table.reload("reloadId", {
							where: {
								"sname": $("#sname").val(),
								"sage": $("#sage").val(),
								"paymentamount": $("#bigSage").val(),
								"sphone": $("#sphone").val(),
								"sqq": $("#sqq").val(),
								"sgender": $("#sgender").val(),
								"szxsid": $("#szxsid").val(),
								"screatetime": $("#screatetime").val(),
								"sourceword": $("#sid").val(),
								"paythefees": $("#paythefees").val(),
								"isvisit": $("#isvisit").val(),
								'iseffect': $("#iseffect").val(),
								"token": globalData.getToken()
							},
							page: {
								curr: 1
							}
						});
					}
				}
				
				//渲染数据表格
				table.render({
					elem: '#demoFollows',
					url: globalData.server + "/follows/getAllFollows",
					method: 'post',
					page: true,
					limit: '10',
					where: {
						'token': globalData.getToken()
					}, //验证
					cols: [[
						{type: 'checkbox'},
						{type: 'numbers', title: '序号', align: 'center'},
						{field: 'student', title: '学生姓名', width: 100, align: 'center',
							templet: "<span>{{d.student.sname}}</span>"
						},
						{field: 'visitcase', title: '回访情况', width: 250, align: 'center'},
						{field: 'trackingmode', title: '跟踪方式', width: 100, align: 'center'},
						{field: 'visittime', title: '跟踪时间', width: 180, align: 'center'},
						{field: 'nexttrackingtime', title: '下次跟踪时间', width: 180, align: 'center'},
						{field: 'stustatus', title: '状态', width: 180, align: 'center'},
						{field: 'fremark', title: '备注', width: 150, align: 'center'},
						{title: '操作', align: 'center', width: 230, toolbar: '#barDemoFollows'}
					]],
					id: "followsReloadId"
				});
				
				var editFollowsOpen;	//点击编辑跟踪记录的layer.open弹窗
				
				//监听工具条 
				table.on('tool(demoFollows)', function(obj) { //注：tool 是工具条事件名，test 是 table 原始容器的属性 lay-filter="对应的值"
					var data = obj.data; //获得当前行数据
					var layEvent = obj.event; //获得 lay-event 对应的值（也可以是表头的 event 参数对应的值）
					var tr = obj.tr; //获得当前行 tr 的 DOM 对象（如果有的话）
					if(layEvent === 'detail'){ //查看
						form.val("detailFollowsForm", data); //数据回显
						layer.open({
							type: 1,
							title: "您正在查看[" + data.student.sname + "]客户的信息",
							anim: 1,
							maxmin: true,
							offset: '80px',
							area: ['700px', '550px'],
							content: $('#detailFollowsDiv')
						});
					} else if(layEvent === 'edit'){ //编辑
						form.val("editFollowsForm", data); //数据回显
						editFollowsOpen = layer.open({
							type: 1,
							title: "您正在编辑[" + data.student.sname + "]客户的信息",
							anim: 1,
							maxmin: true,
							offset: '80px',
							area: ['700px', '550px'],
							content: $('#editFollowsDiv')
						});
					} else if(layEvent === 'del'){ //删除
						layer.confirm("确认删除这条数据吗？", function(){
							var delUrl = globalData.server + "/follows/del";	//请求地址
							//请求参数
							var strData = {
								"fid": data.fid,
								"token": globalData.getToken()
							}
							//post请求
							$.post(delUrl, strData, function(res){
								if (res > 0) {
									layer.msg("删除成功!", {icon : 1});
									activeFollows.reload();
								} else{
									layer.msg("删除失败!", {icon : 5});
								}					
							}, "json");
						});
					}
				});
				
				//监听提交   修改跟踪日志
				form.on('submit(editFollowsBtn)', function(data) {
					var followsUrl = globalData.server + "/follows/edit"; //请求地址
					var strData = $("#editFollowsForm").serialize() + "&token=" + globalData.getToken();
					//发异步，把数据提交给java
					$.post(followsUrl, strData, function(res) {
						if(res.code > 0) {
							layer.close(editFollowsOpen);
							layer.msg(res.msg, {icon: 1});
							activeFollows.reload();
						} else {
							layer.msg(res.msg, {icon: 5});
						}
					}, "json");
					return false;
				});
				
				//跟踪记录批量删除
				$("#delListBtn").on("click", function(){
					var check = table.checkStatus("followsReloadId");	//获取数据表格
					var data = check.data;	//获取数据表格里面的数据
					var ids = [];	//创建数据，存储uid
					//遍历选中的数据
					for (var i = 0; i < data.length; i++) {
						ids.push(data[i].fid);	//取出uid并添加到数组中
					}
					var idJoin = ids.join(",");  //使用逗号分隔uid
					if (ids == null || ids == "") {	//判断是否勾选了数据
						layer.msg("请先选择要删除的数据", {icon : 5});	//没选择给出提示
						return false;	//结束方法
					}
					layer.confirm("确认删除这["+ ids.length +"]条数据吗？", function(){
						var delUrl = globalData.server + "/follows/del";	//请求地址
						//请求参数
						var strData = {
							"fid": idJoin,
							"token": globalData.getToken()
						}
						//post请求
						$.post(delUrl, strData, function(res){
							if (res > 0) {
								layer.msg("删除成功!", {icon : 1});
								activeFollows.reload();
							} else{
								layer.msg("删除失败!", {icon : 5});
							}					
						}, "json");
					});
					return false;
				});
				
				//点击日志信息检索按钮时触发
				$("#searshFollows").on("click", function() {
					activeFollows.reload();
					return false;
				});
				
				/**
				 * 重载日志数据表格的方法
				 * 参数 sname sage sphone sqq sgender paythefees isvisit
				 */
				activeFollows = {
					reload: function() {
						table.reload("followsReloadId", {
							where: {
								"trackingmode": $("#searchTrackingmode").val(),
								"visittime": $("#searchBeginTime").val(),
								"fremark": $("#searchEndTime").val(),
								"token": globalData.getToken()
							},
							page: {
								curr: 1
							}
						});
					}
				}
				
				//分配时，显示咨询师的下拉框
				$.post(globalData.server + "/users/getAllZxsname", {
					"token": globalData.getToken()
				}, function(res) { //遍历返回的数据
					$.each(res, function(index, item) {
						$(".zxs").append(new Option(item.loginname, item.protectmtel));
					});
					layui.form.render();
				}, "json");
				
				//未分配学生的数据表格第一个实例
				table.render({
					elem: '#demoWfpxs',
					url: globalData.server + "/students/getAllWfpstu",
					method: 'post',
					page: true, //开启分页
					limit: '10',
					where: {'token': globalData.getToken()},
					toolbar: '#toolbarDemoWfpxs', //开启头部工具栏，并为其绑定左侧模板
					cols: [[ //表头
						{type: 'checkbox'},
						{type: 'numbers', title: '序号', align: 'center', width: 100},
						{field: 'sname', title: '学生姓名', align: 'center', width: 425},
						{field: 'sage', title: '年龄', align: 'center', width: 300},
						{field: 'sgender', title: '性别', align: 'center', width: 300},
						{title: '操作', align: 'center', toolbar: '#barDemoWfpxs', width: 300}
					]],
					id: "reloadIdWfpxs"
				});
				
				var idsWfpxs = [];	//创建数组 存储sid参数
				var repeatSnameWfpxs = [];	//存储重复数据
				//头工具栏事件
			    table.on('toolbar(testWfpxs)', function(obj){
				    switch(obj.event){
				        case 'exportLieBiaoWfpxs':
					        var check = table.checkStatus("reloadIdWfpxs"); //获取数据表格
							var data = check.data; //获取数据表格里的数据
							repeatSnameWfpxs = [];
							for(var i = 0; i < data.length; i++) {
								for(var j = 0; j < idsWfpxs.length; j++) {
									if(data[i].sid == idsWfpxs[j]) {
										repeatSnameWfpxs.push(data[i].sname);
									}
								}
							}
							if(repeatSnameWfpxs.length > 0) {
								layer.alert("所选包含重复数据:" + repeatSnameWfpxs, {icon: 3});
								return false;
							}
							//遍历数据
							for(var i = 0; i < data.length; i++) {
								idsWfpxs.push(data[i].sid); //取出sid并添加到数组中
							}
							if(data.length < 1) {
								layer.msg("您还没有选择数据", {icon: 5});
								return false;
							}
							layer.msg("当前" + data.length + "条数据已添加至列表", {icon: 1});
				        	break;
				        case 'exportFileWfpxs':
				        	var idJoin = idsWfpxs.join(","); //使用逗号分隔参数
							if(idsWfpxs == null || idsWfpxs == "") { //判断是否勾选了数据
								layer.msg("请先添加要批量分配的学生", {icon: 5});
								return false; //如果没有勾选 给出提示并结束方法
							}
							layer.confirm("共选择了【" + idsWfpxs.length + "】条数据，确认分配吗？", function() {
								layer.open({
									type: 1,
									title: "您正在批量分配学生",
									anim: 1,
									maxmin: true,
									offset: '30px',
									area: ['600px', '400px'],
									content: $('#PLeditDiv'),
									cancel: function(index, layero) { //弹窗关闭时的回调函数
										layer.msg("已关闭", {icon: 6}); //提示已关闭
										$("#PLnum").val("");
										layer.close(index); //关闭弹出层
										return false;
									}
								});
								form.on('submit(PLeditBtn)', function(data) {
									var addUrl = globalData.server + "/students/editStuZxsD"; //请求地址
									var strData = $("#PLeditForm").serialize() + "&token=" + globalData.getToken() + "&ids=" + idJoin;
									//发异步，把数据提交给java
									$.post(addUrl, strData, function(res) {
										if(res.code > 0) {
											layer.closeAll();
											layer.msg(res.msg, {icon: 1});
											idsWfpxs = [];	//分配成功后 清空id数组 方便下次存储数据
											repeatSnameWfpxs = [];	//分配成功后 清空重复数据 方便下下次提示
											$("#PLeditForm")[0].reset();
											activeWfpxs.reload();
											active.reload();
										} else {
											layer.msg(res.msg, {icon: 5});
										}
									}, "json");
									return false;
								});
							});
				        	break;
				        case 'testFenpei':
				        	layer.confirm("确认使用自动分配吗？", {icon: 6}, function(){
				        		var addUrl = globalData.server + "/students/testFenpei"; //请求地址
								var strData ={"token" : globalData.getToken()}
								//发异步，把数据提交给java
								$.post(addUrl, strData, function(res) {
									if (res == 1) {
										layer.msg("分配成功", {icon: 1});
										activeWfpxs.reload();
										active.reload();
									} else if (res == 0) {
										layer.msg("分配失败", {icon: 2});
									} else if (res == 3) {
										layer.msg("没有在线的咨询师", {icon: 5});
									}
								}, "json");
				        	});
							break;
				      	case 'LAYTABLE_TIPS':	//自定义头工具栏右侧图标 - 提示
				        	layer.alert('这是工具栏右侧自定义的一个图标按钮');
				      		break;
				    };
			    });

				//监听工具条 
				table.on('tool(testWfpxs)', function(obj) { //注：tool 是工具条事件名，test 是 table 原始容器的属性 lay-filter="对应的值"
					var data = obj.data; //获得当前行数据
					var layEvent = obj.event; //获得 lay-event 对应的值（也可以是表头的 event 参数对应的值）
					var tr = obj.tr; //获得当前行 tr 的 DOM 对象（如果有的话）
					if(layEvent === 'detail') { //查看
						form.val("editWfpxsForm", data); //数据回显
						layer.open({
							type: 1,
							title: "您正在给[" + data.sname + "]分配咨询师",
							anim: 1,
							maxmin: true,
							offset: '100px',
							area: ['600px', '400px'],
							content: $('#editWfpxsDiv'),
							cancel: function(index, layero) { //弹窗关闭时的回调函数
								layer.msg("已关闭", {icon: 6}); //提示已关闭
								$("#num").val("");
								layer.close(index); //关闭弹出层
								return false;
							}
						});
					}
				});
				
				//单独分配人数
				form.on('select(uphone)', function(dataObj) {
					provinceText = $("#uphone").find("option:selected").text();
					var value = $("#uphone").val();
					var kcurl = globalData.server + "/students/getCountzxsNum";
					var kcdata = {
						"uphone": value,
						"token": globalData.getToken()
					};
					//异步加载下拉框数据
					$.post(kcurl, kcdata, function(data) {
						var $html = "";
						if(data != null) {
							$("#num").val(data);
							$("#num").append($html);
							form.render('select');	//append后必须从新渲染
						}
					}, 'json');
				});

				//批量分配人数
				form.on('select(PLuphone)', function(dataObj) {
					provinceText = $("#PLuphone").find("option:selected").text();
					var value = $("#PLuphone").val();
					var kcurl = globalData.server + "/students/getCountzxsNum";
					var kcdata = {
						"uphone": value,
						"token": globalData.getToken()
					};
					//异步加载下拉框数据
					$.post(kcurl, kcdata, function(data) {
						var $html = "";
						if(data != null) {
							$("#PLnum").val(data);
							$("#PLnum").append($html);
							//append后必须从新渲染
							form.render('select');
						}
					}, 'json');
				});

				//监听提交   单个分配
				form.on('submit(editWfpxsBtn)', function(data) {
					var addUrl = globalData.server + "/students/editStuZxs"; //请求地址
					var strData = $("#editWfpxsForm").serialize() + "&token=" + globalData.getToken();
					//发异步，把数据提交给java
					$.post(addUrl, strData, function(res) {
						if(res.code > 0) {
							layer.closeAll();
							layer.msg(res.msg, {icon: 1});
							$("#editWfpxsForm")[0].reset();
							activeWfpxs.reload();
							active.reload();
						} else {
							layer.msg(res.msg, {icon: 5});
						}
					}, "json");
					return false;
				});

				//点击检索按钮时触发
				$("#searshWfpxs").on("click", function() {
					activeWfpxs.reload();
				});

				/**
				 * 重载数据表格的方法
				 * 参数 sname sage sgender
				 */
				activeWfpxs = {
					reload: function() {
						table.reload("reloadIdWfpxs", {
							where: {
								"sname": $("#snameWfpxs").val(),
								"sage": $("#sageWfpxs").val(),
								"paymentamount": $("#bigSageWfpxs").val(),
								"sgender": $("#sgenderWfpxs").val(),
								"token": globalData.getToken()
							},
							page: {
								curr: 1
							}
						});
					}
				}
				
				//iseffectShi iseffectFou 监听是否有效
				form.on('radio(iseffectShi)', function(data){
				  	$("#editInvalidcause").prop("disabled", "disabled");
					$("#editInvalidcause").attr("style", "background-color: lightgray;");
					$("#editInvalidcause").val("");
				});  
				form.on('radio(iseffectFou)', function(data){
					$("#editInvalidcause").removeAttr("disabled");
					$("#editInvalidcause").removeAttr("style");
				});  
				//isfirstvisitShi isfirstvisitFou 监听是否回访
				form.on('radio(isfirstvisitShi)', function(data){
				  	$("#editFirstvisittime").removeAttr("disabled");
					$("#editFirstvisittime").removeAttr("style");
				});  
				form.on('radio(isfirstvisitFou)', function(data){
					$("#editFirstvisittime").prop("disabled", "disabled");
					$("#editFirstvisittime").attr("style", "background-color: lightgray;");
					$("#editFirstvisittime").val("");
				}); 
				//isvisitShi isvisitFou 监听是否上门
				form.on('radio(isvisitShi)', function(data){
				  	$("#editVisittime").removeAttr("disabled");
					$("#editVisittime").removeAttr("style");
				});  
				form.on('radio(isvisitFou)', function(data){
					$("#editVisittime").prop("disabled", "disabled");
					$("#editVisittime").attr("style", "background-color: lightgray;");
					$("#editVisittime").val("");
				}); 
				//paythefeesShi paythefeesFou 监听是否缴费
				form.on('radio(paythefeesShi)', function(data){
					$("#editPaythefeestime").removeAttr("disabled", "disabled");
					$("#editPaythefeestime").removeAttr("style", "background-color: lightgray;");
					$("#editPaymentamount").removeAttr("disabled", "disabled");
					$("#editPaymentamount").removeAttr("style", "background-color: lightgray;");
				});  
				form.on('radio(paythefeesFou)', function(data){
					$("#editPaythefeestime").prop("disabled", "disabled");
					$("#editPaythefeestime").attr("style", "background-color: lightgray;");
					$("#editPaymentamount").prop("disabled", "disabled");
					$("#editPaymentamount").attr("style", "background-color: lightgray;");
					$("#editPaythefeestime").val("");
					$("#editPaymentamount").val("");
				});
				//isoutpayShi isoutpayFou 监听是否退费
				form.on('radio(isoutpayShi)', function(data){
					$("#editIsoutpaycause").removeAttr("disabled", "disabled");
					$("#editIsoutpaycause").removeAttr("style", "background-color: lightgray;");
					$("#editIsoutpaytime").removeAttr("disabled", "disabled");
					$("#editIsoutpaytime").removeAttr("style", "background-color: lightgray;");
				});  
				form.on('radio(isoutpayFou)', function(data){
					$("#editIsoutpaycause").prop("disabled", "disabled");
					$("#editIsoutpaycause").attr("style", "background-color: lightgray;");
					$("#editIsoutpaytime").prop("disabled", "disabled");
					$("#editIsoutpaytime").attr("style", "background-color: lightgray;");
					$("#editIsoutpaycause").val("");
					$("#editIsoutpaytime").val("");
				});
				//intheclassShi intheclassFou 监听是否进班
				form.on('radio(intheclassShi)', function(data){
				  	$("#editIntheclasstime").removeAttr("disabled");
					$("#editIntheclasstime").removeAttr("style");
				});  
				form.on('radio(intheclassFou)', function(data){
					$("#editIntheclasstime").prop("disabled", "disabled");
					$("#editIntheclasstime").attr("style", "background-color: lightgray;");
					$("#editIntheclasstime").val("");
				}); 
				
				//执行一个laydate实例  学生信息创建时间的开始时间
				laydate.render({
					elem: '#screatetime', //指定元素
					type: 'datetime'
				});
				//结束时间
				laydate.render({
					elem: '#sid', //指定元素
					type: 'datetime'
				});
				
				//执行一个laydate实例
				laydate.render({
					elem: '#editScreatetime', //指定元素
					type: 'datetime'
				});
				
				//执行一个laydate实例
				laydate.render({
					elem: '#editFirstvisittime', //指定元素
					type: 'datetime'
				});
				
				//执行一个laydate实例
				laydate.render({
					elem: '#editVisittime', //指定元素
					type: 'datetime'
				});
				
				//执行一个laydate实例
				laydate.render({
					elem: '#editHandsetime', //指定元素
					type: 'datetime'
				});
				
				//执行一个laydate实例
				laydate.render({
					elem: '#editPaythefeestime', //指定元素
					type: 'datetime'
				});
				
				//执行一个laydate实例
				laydate.render({
					elem: '#editIsoutpaytime', //指定元素
					type: 'datetime'
				});
				
				//执行一个laydate实例
				laydate.render({
					elem: '#editIntheclasstime', //指定元素
					type: 'datetime'
				});
				
				//执行一个laydate实例
				laydate.render({
					elem: '#followsVisittime', //指定元素
					type: 'datetime'
				});
				
				//执行一个laydate实例
				laydate.render({
					elem: '#followsNexttrackingtime', //指定元素
					type: 'datetime'
				});
				
				//执行一个laydate实例
				laydate.render({
					elem: '#searchBeginTime', //指定元素
					type: 'datetime'
				});
				
				//执行一个laydate实例
				laydate.render({
					elem: '#searchEndTime', //指定元素
					type: 'datetime'
				});
				
				//执行一个laydate实例
				laydate.render({
					elem: '#editFollowsVisittime', //指定元素
					type: 'datetime'
				});
				
				//执行一个laydate实例
				laydate.render({
					elem: '#editFollowsNexttrackingtime', //指定元素
					type: 'datetime'
				});
				
				
			//layui.use的括号
			});
			
			//handselmoneyBlur()	订金金额的失去焦点事件
			function handselmoneyBlur(){
				var editHandselmoney = $("#editHandselmoney").val();
				if (editHandselmoney == "") {
					$("#editHandsetime").prop("disabled", "disabled");
					$("#editHandsetime").attr("style", "background-color: lightgray;");
					$("#editHandsetime").val("");
				} else {
					$("#editHandsetime").removeAttr("disabled");
					$("#editHandsetime").removeAttr("style");
				}
			}
			
		</script>
	</body>

</html>